<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

<title>Empréstimo de Bicicletas</title>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/custom.css">

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script	type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBBMEqiqFXjjF1rQNA6RITM3MyhJRBCGD4"></script>
<script	type="text/javascript" src="/js/mapa.js"></script>

<script type="text/javascript">	

	$(document).ready(function() {
		
		function carregarNoMapa(endereco) {
	        geocoder.geocode({ 'address': endereco + ', Brasil', 'region': 'BR' }, function (results, status) {
	            if (status == google.maps.GeocoderStatus.OK) {
	                if (results[0]) {
	                    var latitude = results[0].geometry.location.lat();
	                    var longitude = results[0].geometry.location.lng();
	 
	                    $('#txtEndereco').val(results[0].formatted_address);
	                    $('#txtLatitude').val(latitude);
	                    $('#txtLongitude').val(longitude);
	 
	                    var location = new google.maps.LatLng(latitude, longitude);
	                    
	                    map.setCenter(location);
	                    map.setZoom(16);
	                }
	            }
	        });
	    }
		
		$("#btnEndereco").click(function() {
			if ($(this).val() != "")
				carregarNoMapa($("#txtEndereco").val());
		});

		$("#txtEndereco").blur(function() {
			if ($(this).val() != "")
				carregarNoMapa($(this).val());
		});
	});
</script>
</head>

<body>
	<form>
	
	<div class="container">
			<div class="form-group col-sm-9">
				<label for="txtEndereco">Endereço:</label> <input type="text"
					id="txtEndereco" class="form-control" name="txtEndereco" />
			</div>

			<div class="col-sm-3">
				<input type="button" id="btnEndereco" name="btnEndereco" class="btn btn-primary" value="Mostrar no mapa" />
			</div>	 
			
			<input type="hidden" id="txtLatitude" name="txtLatitude" /> 
			
			<input type="hidden" id="txtLongitude" name="txtLongitude" /> 
			
			<br />

			<div id="mapa" style="width: 100%; height: 600px"></div>
		</div>

	</form>
</body>

</html>